{
  "$schema": "http://json-schema.org/draft-04/schema",
  "title": "tas-answer",
  "description": "An item anwser",
  "definitions": {

    "tas-file": {
      "description": "Uploaded file",
      "type": "object",
      "properties": {
        "data": {
          "type": "string",
          "media": {
              "binaryEncoding": "base64"
          }
        },
        "mimeType":   { "type": "string" },
        "name":       { "type": "string" },
        "via":        { "type": "string" },
        "url":        { "type": "string" },
        "confirmUrl": { "type": "string" }
      }
    },

    "tas-stringAnswer": {
      "description": "Schema for string answer",
      "type": "object",
      "properties": {
        "value": {
          "description": "Answer for this item",
          "type": "string"
        }
      }
    },

    "tas-chronoAnswer": {
      "description": "Schema for string answer",
      "type": "object",
      "properties": {
        "value": {
          "description": "Answer for this item",
          "type": "string"
        }
      }
    },

    "tas-singleLineAnswer": {
      "description": "Schema for singleLine answer",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["singleLine"]
             }
           }
         }
      ]
    },

    "tas-multilineAnswer": {
      "description": "Schema for multiline answer",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["multiline"]
             }
           }
         }
      ]
    },

    "tas-numberAnswer": {
      "description": "Schema for number answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["number"]
        },
        "value": {
          "description": "Answer for this item",
          "type": "number",
          "multipleOf" : 1,
          "minimum": -2147483648,
          "maximum": 2147483647
        }
      }
    },

    "tas-boolAnswer": {
      "description": "Schema for boolean answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["bool"]
        },
        "value": {
          "description": "Answer for this item",
          "type": "boolean"
        }
      }
    },

    "tas-imageAnswer": {
      "description": "Schema for image answer",
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/tas-file" },
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["image"]
            },
            "format": {
              "description": "Mime type of file",
              "type": "string"
            }
          }
        }
      ]
    },

    "tas-documentAnswer": {
      "description": "Schema for document answer",
      "type": "object",
      "allOf": [
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["document"]
            },
            "signed": {
              "description": "Is this a signed document",
              "type": "boolean"
            },
            "signature": {
              "description": "Signature answer",
              "type": "object",
              "allOf": [ { "$ref": "#/definitions/tas-signatureAnswer" } ]
            }
          }
        },
        { "$ref": "#/definitions/tas-file" }
      ]
    },

    "tas-audioAnswer": {
      "description": "Schema for aduio answer",
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/tas-file" },
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["audio"]
            },
            "language": {
              "description": "Recorded language",
              "type": "string"
            }
          }
        }
      ]
    },

    "tas-enumAnswer": {
      "description": "Schema for enum answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enum"]
        },
        "value": {
          "description": "Selection for this item",
          "type": "string"
        }
      }
    },

    "tas-enumMultiAnswer": {
      "description": "Schema for enum multi-select answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enumMulti"]
        },
        "value": {
          "description": "Selections for this item",
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },

    "tas-enumDetailsAnswer": {
      "description": "Schema for enum with more details answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enumDetails"]
        },
        "value": {
          "description": "Selections and details for this item",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "choice":  {"type": "string"},
              "details": {"type": "string"}
            }
          }
        }
      }
    },

    "tas-enumQuestionsAnswer": {
      "description": "Schema for enum with more questions answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enumQuestions"]
        },
        "value": {
          "description": "Selections and details for this item",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "choice":  {"type": "string"},
              "answers": {
                 "type": "array",
                 "items": {
                    "$ref": "#"
                 }
              }
            }
          }
        }
      }
    },

    "tas-categoryAnswer": {
      "description": "Schema for category answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["category"]
        },
        "value": {
          "description": "Selections for this item",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },

    "tas-sheetAnswer": {
      "description": "Schema for sheet answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["sheet"]
        },
        "rows": {
          "description": "Array of submitted rows",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "column": {"type": "string"},
              "value":  {"type": "string"}
            }
          }
        }
      }
    },

    "tas-wysiwygAnswer": {
      "description": "Schema for wysiwyg answer",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["wysiwyg"]
             }
           }
         }
      ]
    },

    "tas-dateAnswer": {
      "description": "Schema for date answer",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["date"]
             }
           }
         }
      ]
    },

    "tas-timeAnswer": {
      "description": "Schema for time answer",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["time"]
             }
           }
         }
      ]
    },

    "tas-datetimeAnswer": {
      "description": "Schema for datetime answer",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["datetime"]
             }
           }
         }
      ]
    },

    "tas-salaryAnswer": {
      "description": "Schema for salary answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["salary"]
        },
        "value": {
          "description": "Answer for this item",
          "type": "string"
        }
      }
    }
  },
  "type": "object",
  "oneOf": [
    { "$ref": "#/definitions/tas-singleLineAnswer" },
    { "$ref": "#/definitions/tas-multilineAnswer" },
    { "$ref": "#/definitions/tas-numberAnswer" },
    { "$ref": "#/definitions/tas-boolAnswer" },
    { "$ref": "#/definitions/tas-imageAnswer" },
    { "$ref": "#/definitions/tas-documentAnswer" },
    { "$ref": "#/definitions/tas-audioAnswer" },
    { "$ref": "#/definitions/tas-enumAnswer" },
    { "$ref": "#/definitions/tas-enumMultiAnswer" },
    { "$ref": "#/definitions/tas-enumDetailsAnswer" },
    { "$ref": "#/definitions/tas-categoryAnswer" },
    { "$ref": "#/definitions/tas-sheetAnswer" },
    { "$ref": "#/definitions/tas-wysiwygAnswer" },
    { "$ref": "#/definitions/tas-dateAnswer" },
    { "$ref": "#/definitions/tas-timeAnswer" },
    { "$ref": "#/definitions/tas-datetimeAnswer" },
    { "$ref": "#/definitions/tas-salaryAnswer" }
  ]
}
