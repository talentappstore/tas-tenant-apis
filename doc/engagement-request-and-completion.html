<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link rel="stylesheet" href="//normalize-css.googlecode.com/svn/trunk/normalize.css" />


<!-- always required -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<!-- needed for sequence diagrams -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/raphael-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/underscore-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/sequence-diagram-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/sequence-diagram-wrapper.js'></script>

<!-- needed for includes -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/clientInclude.js'></script>

<!-- needed for table of contents -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/tocify.js'></script>

<!-- always required -->
<link rel='stylesheet' href='http://talentappstore.github.io/tas-des-static/css/des.css' type='text/css' media='all' />


<title>Engagement APIs</title>
</head>
<body>


<h1>Table of contents</h1>

<div id="toc"></div>


<h1>See</h1>

http://www.oracle.com/technetwork/fusion-apps/tasm12a-configguide-enus-1647788.pdf


<h1>Overview</h1>

<p>The engagement APIs allow a tenant to use a third party (an engagement vendor) to perform some
kind of engagement action on a candidate or a job application, where that interaction results in data
that helps predict the candidate's suitability for employment.
</p>

<p>The API design is informed by the work of the HR-XML consortium, but is also suitable for very lightweight
engagements.
</p>
 
<p>An engagement might be anywhere along the scale from attract to hire, and might or might not involve
the candidate themselves, for example:
<ul>
<li>undertaking a skills assessment
<li>carrying out reference checks
<li>cultural/fit analysis
<li>carrying out medical checks or drug tests
<li>gamification interaction
<li>probity check
<li>HR-XML style assessment 
</ul>
</p>

<h1>Apps</h1>

<p>The diagram below shows the tenants and apps involved.
</p>

<p>The engagement vendor requires their own tenant.
</p>

<b><div class='codeBlock'>

                +-----+         +----------------+
     +--------->| ats |<------->| engagement app |-+
     |          +-----+         +----------------+ |-+
     |            /\              +----------------+ |
     |             |                +----------------+
    \/             |                  /\
 +-------------+   |                   |
 | engageui    |   |                   |
 +-------------+   |                   |
         |         |                   |
        \/        \/                  \/
      +------------------------------------+
      |     engagement hub                 |
      +------------------------------------+
                        /\
                         .
customer                 .  (communication via shared database)
tenant                   .
~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~~ ~ ~ ~ ~ ~ ~ ~~ ~ ~ ~ ~ ~ ~ ~
vendor                   .
tenant                   . 
                        \/
           +--------------------------+    +-----------------+
           |  engagement vendor app   |<-->|  vendor ui app  |
           +--------------------------+    +-----------------+
           
</div>
</b>

<h2>Engagement app(s)</h2>

<p>The engagement  vendor delivers their engagement functionality as an app (an engagement app) that the
tenant can install.
</p>

<h2>Engagement hub app</h2>

<p>As well as the engagement apps they want, the tenant must also install a single "engagement hub"
app.
</p>

<p>The engagement hub provides centralized engagement
management and is separate from any single engagement app.
</p>

<p>It is tightly coupled (via shared database) to the engagement vendor app.
</p>

<p>The engagement hub app:
<ul>
<li>stores details of all engagement, including status, summary and detailed results
(including scores), links and actual attachments (documents)
<li>reuses results when an existing report is available within the expiry time - reduces costs and candidate inconvenience 
<li>stores the tenant's installed engagement
apps - for example, the "Microsoft Office proficiency assessment app"
<li>stores a tenant-specific list of deployed engagement types within each engagement
app - for example "MS Word proficiency - entry level", "MS Excel proficiency - guru"
<li>allows the tenant to overwrite the title on each engagement type (for example, to rename
"MS Excel proficiency - guru" to "Excel expert"
<li>allows the tenant to specify a view against each engagement type - e.g. to make available the candidate's
completed "FSA disclosure" document when a "Finance team probity check" is performed. 
<li>provides APIs so the engagement vendor can manage engagement types directly
for any given tenant (e.g. to populate a default engagement type for new tenants).
<li>stores the completed engagements
<li>securely mediates engagement app access to views of information about the
candidate/application, and prevents engagement apps from probing candidates they
are not authorized to access
<li>audits changes in view data (e.g. seeing when, in the ATS, an additional
document was uploaded against the candidate while the engagement is in progress)
</ul>

<h2>engageui app</h2>

<p>The engageui app allows easy embedding of engagements within an ats.
</p>

<p>The ats asks engageui for an html fragment, and then renders that alongside other application details.
</p>

<p>The fragment contains buttons that can be used to order, view results and otherwise interact with engagements via ajax calls, without any
other integration with the ats.
</p>

<h2>Engagement vendor app</h2>

<p>A developer who is an engagement vendor must maintain a tenant of their own, and must
install the engagement vendor app. Covered more in detail below.
</p>

<h2>Engagement vendor admin UI app</h2>

<p>An engagement vendor will also usually install the engagementvendoradminui app which provides UI to:
<ul>
<li>View engagement apps 
<li>View tenants that have installed each app
<li>Manually manage engagement types for each install
</ul>
</p>

<p>Other more automated engagement vendors can manage engagement types through the APIs from their own platform.
</p>

<h2>Engagement vendor results UI app</h2>

<p>An engagement vendor who does not have their own IT systems can install the results app.

<ul>
<li>Browse for outstanding engagements
<li>See data from the related view
<li>Enter results manually, including attachments
<li>Finalize
</ul>
</p>

<p>Other more automated engagement vendors can manage and attach results for engagements via APIs.
</p>


<h1>API design notes</h1>

<h2>Engagement types</h2>

<p>An app can present a number of engagement types to the tenant.
</p>
 
<p>Some engagement apps may provide highly customised
engagement types, tailored to each individual customer's needs (e.g., "Acme finance graduate assessment").
Others may present just a single, generally applicable screen (e.g. "MS Word proficiency").
</p>


<h2>Differences from HR-XML</h2>

<p>The design of the engagement APIs is informed by HR-XML but does not follow it slavishly.
</p>
 
<p>The HR-XML ScreeningResultTypeCode is not currently supported, as some of its possible values 
('Result'|'SummaryResult'|'Error'|'Message'|'Status'|'ManagementReport'|'MultipleResults') clash
with ScreeningStatusCode values (e.g. Error), or are not suited to microservices (e.g. MultipleResults).
</p>

<p>The ScreeningResultCode is not currently supported, as some of its possible values
('Pass'|'Fail'|'Review'|'RecordFound'|'NoRecordFound'|'Clear'|'UnableToContact'|
'UnableToFulfill'|'UnableToVerify'|'Positive'|'Negative') are ambiguous (HR-XML notes that
*this set of codes usually would need to be interpretated based on the type of screening and pre-existing understanding
between service provider and customer on criteria governing the application of the codes*), e.g. Pass vs Positive.
</p>

<h1>Scenarios</h1>

<h2>Tenant installs an engagement app</h2>

TODO: update to use new possibles APIs

<div class='seqDiag' id="installing">
participant TAS
participant ats
participant hub
participant engagementapp
note right of TAS: new customer (tenant)\nclicks install on the app
TAS->engagementapp: POST /tenants/{}
TAS->engagementapp: POST /tenants/{}/preStarts
TAS->engagementapp: POST /tenants/{}/starts
note left of engagementapp: vendors sets up per-customer\nengagement types
engagementapp->hub: POST /deployedEngagementTypes
</div>


<h2>Tenant views a list of applications</h2>

<p>In this scenario:
<ol>
<li>a recruiter is using the ats to view a list of job applications
<li>against each application appears:
	<ul>
	<li>a list of buttons for each potential engagement
	<li>a list of buttons for each underway or completed engagement
	<li>both repeated, this time for the candidate
	</ul>
</li>
</ol>
</p>


<div class='seqDiag' id="o">
participant app
participant hub
note right of ats: ats is about to display applications 20, 21 and 22

note right of ats: ats requests the completed, or in-progress actions for the applications
ats-->>switchgear: GET SoT /actions/byUser/me/started/applications?applications=20,21,22
note left of switchgear: The engagement hub injects relevant engagements as actions
switchgear->hub: GET Non-SoT /actions/byUser/me/started/applications/forApp?applications=20,21,22

note right of ats: ats requests the startable user-facing actions relevant to these applications
ats-->>switchgear: GET SoT /actions/byUser/me/applications?applications=20,21,22
note left of switchgear: switchgear consults own database for allowable application actions
note left of switchgear: based on application's bucket, job's workflow, any manual override
note left of switchgear: the hub presents a rollup of all actions that are engagements,
note left of switchgear: i.e. it is the hub that processes the "start" engagement
switchgear->hub: GET non-SoT /actions/byUser/me/applications/byName/{action}/byApp?applications=20,21,22

note right of ats: TODO - same, but now for the candidates (i.e. that own the applications)

for candidate?
for application?
re-use?


</div>

<h2>Candidate initiates an engagement</h2>

<h2>User/recruiter initiates an engagement</h2>

<p>In this scenario:
<ol>
<li>the tenant browses to the job application and clicks on the action button for testly, hosted by the engagement hub
<li>engagement hub initiates the engagement, and signals the engagement app
<li>candidate is sent a link to complete their part
<li>once candidate action is complete, testly performs their own part by reviewing the candidate's results/outcomes (CV, etc.)
<li>finally testly pushes the results back
</ol>
</p>



<div class='seqDiag' id="ordering">
note right of hub: user clicks to start an action, which for\nthe hub means to kick off a new engagement,\nthen signal app
hub->app: POST non-SoT /engagements/byType/{type}/deltaPings
note right of app: should be on-behalf?


ZZZZZZZZZZ
try and find an existing one to reuse






/applications/byID/{application}





note right of ats: ats knows to order a testly engagement\nfor every candidate who successfully applies
note right of ats: ats checks testly still available for ordering
ats->hub: GET /deployedEngagementTypes
note right of ats: customer orders the engagement
ats-->hub: POST /deployedEngagementTypes/{}/engagements
note left of engagementapp: vendor is informed of the order
hub-->engagementapp: POST /engagements/viaTicket/{}/deltaPings
note left of engagementapp: engagement app requests more\ndetails about the order
engagementapp->hub: GET /engagements/viaTicket/{}
note left of engagementapp: this is a candidate-completed assessment, so the engagement app\nupdates the report to include a candidate invite link.\nSince the hub is still inside POST /deployedEngagementTypes\n(or POST /engagements/{}), it suppresses pings being\nsent back to the ats, hence this does NOT cause a ping loop.
engagementapp->hub: POST /engagements/viaTicket/{}/report
note left of engagementapp: ping processing complete, return
hub->engagementapp: POST /engagements/viaTicket/{}/deltaPings
note right of ats: POST processing complete, return
ats->hub: POST /deployedEngagementTypes/{}/engagements
note right of ats: ats asks if a candidate invite was provided
ats->hub: GET /engagements/{}/ticket
ats->hub: GET /engagements/viaTicket/{}/report
note right of ats: ats displays invite message to candidate,\nredirects their browser
note left of engagementapp: .. time passes ..
note left of engagementapp: candidate has completed their part, now\nthe second part begins
note left of engagementapp: engagement app requests the view\n(candidate information)
engagementapp-->hub: GET /engagements/viaTicket/{}/latestView
note left of hub: hub fetches the view content, checks\nif it has changed since last time
hub->ats: GET /views/{}
note left of engagementapp: .. time passes ..
note left of engagementapp: vendor provides report
engagementapp->hub: POST /engagements/viaTicket/{}/report
note left of hub: ats is informed of the report,\nand makes it available to the end user
hub->ats: POST /engagements/{}/report/deltaPings
ats->hub: GET /engagements/{}/ticket
ats->hub: GET /engagements/viaTicket/{}/report
ats->hub: GET /engagements/viaTicket/{}/inRowImageUri
ats->hub: GET /engagements/viaTicket/{}/cardUri
</div>

<h3>In detail</h3>


<p>ats knows to order a testly engagement for every candidate who successfully applies.
</p>

<p>ats checks testly still available for ordering by asking the engagement hub app for the list of available
engagement types, as served up by the sum of the installed engagement apps.



<div class='codeBlock'>
GET /deployedEngagementTypes

Response:
<div class='clientInclude' data-href='../examples/deployedEngagementTypes-simple.json'></div>
</div>
</p>

<p>When engagements are ordered manually, the ats might filter this list, to only present certain engagement apps/ screen types
for certain jobs, according to some mappings held by the ATS, e.g. only call center candidates are asked to undertake this assessment.

<p>customer orders the engagement
<div class='codeBlock'>
POST /deployedEngagementTypes/{}/engagements

Request:
<div class='clientInclude' data-href='../examples/engagementCreate-simple.json'></div>

Response:
... (blocks)
</div>
</p>

<p>The hub commits the new engagement to its database. This allows it to start producing APIs like GET /engagements/viaTicket/{}. 
</p>

<p>The hub pings the relevant engagement app to tell it about the order. Engagements are identified by ticket, not by id, to prevent
engament apps from probing engagements they should not see. 
<div class='codeBlock'>
POST /engagements/viaTicket/kuh7645gf8o7hngf635f7o8huyg/deltaPings

Request:
<div class='clientInclude' data-href='../examples/deltaPing-simple.json'></div>

Response:
... (blocks)
</div>
</p>

<p>This is (partly) a candidate-completed assessment, so the engagement app somehow needs to smuggle a link to the
candidate and ask them to follow it.
</p>

<p>The engagement app starts by requesting more detail about the ordered engagement
(as identified by the ticket passed in the ping call).
</p>

<div class='codeBlock'>
GET /engagements/viaTicket/kuh7645gf8o7hngf635f7o8huyg

Response:
<div class='clientInclude' data-href='../examples/engagementRead-created.json'></div>
</div>
</p>

<p>There's not all that much to see - candidate name, etc.
</p>

<p>We do see though that "inviteCandidate" is false - that means that
the engagement app should not send an email to the candidate, instead it should put the candidate invite link on the engagement report,
so that the ats can issue the invite (hopefully by immediately redirecting the candidate's browser).
<div class='codeBlock'>
POST /engagements/viaTicket/kuh7645gf8o7hngf635f7o8huyg/report

Request:
<div class='clientInclude' data-href='../examples/engagementReportWrite-invite.json'></div>
</div>
</p>

<p>Since the hub is still blocking inside POST /deployedEngagementTypes (POST /engagements/{} works the same), it suppresses pings being
sent back to the ats, hence this does NOT cause a ping loop.
</p>

<p>Ping processing is now complete, return.

<div class='codeBlock'>
POST /engagements/viaTicket/kuh7645gf8o7hngf635f7o8huyg/deltaPings

Request:
...

Response:
200
</div>
</p>

<p>Now that all ping processing has completed, the call to POST /deployedEngagementTypes/{}/engagements
completes, passing control back to the ats.

<p>customer orders the engagement
<div class='codeBlock'>
POST /deployedEngagementTypes/{}/engagements

Request:
...

Response:
<div class='clientInclude' data-href='../examples/engagementRead-created.json'></div>
</div>
</p>

<p>The ats now checks whether the engagement app set up an invite.
</p>

<p>It must first trade its id for a ticket, since all access to engagements is via ticket. 
<div class='codeBlock'>
GET /engagements/{}/ticket

Response:
890453924485634239058
</div>

<br />

<div class='codeBlock'>
GET /engagements/viaTicket/890453924485634239058/report

Response:
<div class='clientInclude' data-href='../examples/engagementReportRead-inviteOnly.json'></div>
</div>
</p>

<p>Looks like the engagement app did indeed set up an invite.
</p>

<p>The ats shows the link to the candidate (still at their browser, having just finished
applying for the job) and redirects their browser. The candidate starts completing the assessment.
</p>

<p>Eventually the candidate has completed their part, now the second part begins.
</p>

<p>Some person back at assessment base now needs to review the candidate's CV and their answers to the
financial probity questions. 
</p>

<p>This package of information about the candidate is called a view.
</p>

<p>A view is a json formatted package containing data embedded (e.g. name, address, answers to screening questions)
and linked (e.g.)resume/CV, cover letter, attached document(s).
</p>

<p>The customer can attach a different view to each deployed engagement type, exposing just
enough information for the engagement app to do its work.
</p>




note left of engagementapp: engagement app requests the view\n(candidate information)
engagementapp-->hub: GET /engagements/viaTicket/{}/latestView
note left of hub: hub fetches the view content, checks\nif it has changed since last time
hub->ats: GET /views/{}
note left of engagementapp: .. time passes ..
note left of engagementapp: vendor provides report
engagementapp->hub: POST /engagements/viaTicket/{}/report
note left of hub: ats is informed of the report,\nand makes it available to the end user
hub->ats: POST /engagements/{}/report/deltaPings
ats->hub: GET /engagements/{}/ticket
ats->hub: GET /engagements/viaTicket/{}/report
ats->hub: GET /engagements/viaTicket/{}/inRowImageUri
ats->hub: GET /engagements/viaTicket/{}/cardUri



<h1>ATS integration</h1>

<p>The ATS may decide to do any of the following:
<ul>
<li>automatic firing
<li>manual firing
<li>on response
   <ul>
   <li>waiting
   <li>moving to a new bucket
   </ul>
<li>showing results summary in a table cell   
<li>reusing existing results
<li>cancelling when declined
</ul>
</p>

<h1>Engagementvendorui screens</h1>

<p>Within their own tenant, the engagement vendor has installed the app "engagementvendorui".</p>

<p>They can use this to see how many engagements they are currently working on, and for which tenants.</p>


<div class='codeBlock'>
+----------+
| Tenants  |
.          +-------------

Tenant   In progress   Completed
------   -----------   ---------
acme     _12_          1023
asb      -             33
airnz    _8_           83
</div>


<div class='codeBlock'>
+-----------------------+
| In progress screens   |
.                       +---------------------

Name                    Date started   Date completed
----                    ------------   --------------
_Johnson Turkeyvo_      14 Oct 2014
_Sally Smart_           17 Oct 2014
_Xi Tung_               2 Nov 2014
</div>




<script>
$(document).ready(function() {

	renderSequenceDiagrams();
	renderClientIncludes();
	renderTOC();
});
</script>


</body>
</html>