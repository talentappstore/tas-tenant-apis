<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link rel="stylesheet" href="//normalize-css.googlecode.com/svn/trunk/normalize.css" />


<!-- always required -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<!-- needed for sequence diagrams -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/raphael-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/underscore-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/sequence-diagram-min.js'></script>
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/sequence-diagram-wrapper.js'></script>

<!-- needed for includes -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/clientInclude.js'></script>

<!-- needed for table of contents -->
<script type="text/javascript" src='http://talentappstore.github.io/tas-des-static/js/tocify.js'></script>

<!-- always required -->
<link rel='stylesheet' href='http://talentappstore.github.io/tas-des-static/css/des.css' type='text/css' media='all' />


<title>Career site</title>
</head>
<body>

<div id="toc"></div>



<h1>Scenario</h1>

<p>This scenario involves these apps:
<ol>
<li>supersite, an app that acts as the career site for a tenant, i.e. lists and allows search for jobs, provides employment branding content,
leads candidates to the apply (or register) processes, and allows them to save jobs.
</ol>
</p>

<h1>Steps</h1>

<h2>Install</h2>

<ol>
<li>Create app "supersite"
<li>Install supersite into tenant
<li>Tenant configures the master
</ol>


<h1>Unresolved</h1>
<pre>
Share job
Referrals
Injecting stuff when job seeker has done a search
	- add to alerts
	- other alerts for employee referrals
Shuld GET /jobs return 	
</pre>


<h2>Primary and secondary job boards</h2>

<p>A tenant can install any number of job boards (e.g. their main career site and a number of
microsites), but one (and only one) needs to be designated as the "primary". Typically the primary would be the
one most prominently linked from the customer's main web site. 
</p>

<p>Other apps need to know the primary job board so that they can create links to jobs (or to the career site itself).
For example an app that sends job alerts via email needs to embed actual job links inside its emails - those links will be to
the job on the primary job board.
</p>

<p>The tenant controls which job board is the primary. Your app probably doesn't need to know unless
it sends emails that should lead to the primary.
</p>


<h2>Declare the URL of your job board</h2>

<p>Other apps need to know the base URL that your board lives at so that they can compose links leading to jobs.
</p>

<p>Your app tells them by producing (as non-SoT) the GET /jobBoard API that other apps call like this: 
<div class='codeBlock'>
curl -H "Authorization: 1234" \
https://acme.supersite.tazzy.io/apps/supersite/dev/tas/jobBoard

<div class='clientInclude' data-href='../examples/jobBoard-simple.json'></div>

{
   "baseUri": "https://awesomeretailcareers.io/careers"
}

</div>
</p>



<h2>Displaying the search screen</h2>

<p>Most job boards will display a screen something like this to allow the user to search for jobs:

<div class='codeBlock'>
Location:  |_Balclutha_______|V]
Expertise: |_Sales roles_____|V]
Type:      |_Part-time_______|V]
Keywords:  [______]
[Search]
</div>
</p>

<p>Displaying a screen like this first involves fetching the categories (each of Location, Expertise and Type above are categories)
via GET /categories, and then fetching the values (which may be hierarchical) via GET /categories/{}/values.
</p>


<h2>Listing and searching jobs</h2>

<p>Your app can get lists of jobs via either the GET /jobs or POST /jobs/searches APIs. These APIs return the same results
but POST /jobs/searches provides more complex searching (since its not subject to limits on the length of query strings).
</p>

<h3>Examples</h3>

<p>List all active jobs
GET /jobs?$filter=active eq true
</p>

<p>List all active jobs in Sydney
</p>

<h3>Filtering out internal jobs</h3>

<p>Unless the user is an internal candidate, you shouldn't display internal jobs. Use the <b>availableInternally</b>
flag to test individual jobs (ideally you'd also check closeDate and internalCloseDate are not in the past just in case
the job closer is lagging).
</p>

<h3>Keyword search</h3>
	

<h3>Listing saved jobs</h3>


<h2>Creating links for jobs</h2>

<p>Probably, your app will display some kind of search results page, probably showing job title and a link to see the details for that
job. This section discusses how you build that link.
</p>

<p>One option would be to use the results of GET /jobs (and POST /jobs/searches). The response includes links to view and apply for
each job. However normally your app shouldn't use these links, but instead should build its own. That's because your app may not
be the primary job board (perhaps the tenant is still just trialing it), but GET /jobs always returns a link that points to the
job as hosted on the primary job board. So using the link from GET /jobs would result in your app erroneously redirecting
the candidate from your job site to the primary one.
</p>

<p>To build job links, your app first needs to know the tenant's desired link format. Link formats are under the tenant's control,
because they influence the way that search engines treat the career site (i.e. SEO). Among other factors, search engines often
favour links that are more human readable.
</p>

<p>Your app fetches the link format by consuming (as SoT) the GET /jobBoardGlobalSettings API: 
<div class='codeBlock'>
curl -H "Authorization: 1234" \
https://acme.supersite.tazzy.io/dev/tas/jobBoardGlobalSettings

<div class='clientInclude' data-href='../examples/jobBoard-simple.json'></div>

{
   "externalJobLinkTemplate": "/jobs/{id}-{code}-{safeTitle}"
   "internalJobLinkTemplate": "/internal/jobs/{id}-{code}-{safeTitle}"
}
</div>
</p>

<p>The values returned in the template elements are URI Templates conforming to
https://tools.ietf.org/html/rfc6570 (level 1). The template is in relative form, and when
creating an absolute link you would prefix it with the same base URL that you provide
in your response to GET /jobBoard. 
</p>

<p>The possible variables you may find are:
ID - always numeric
safeTitle - space replaced with - etc.
	NEED TO ADD safeTitle to GET /jobs!
code - alphanumeric only

These values are available from GET /jobs.
</p>

<p>When building links for a visitor at your app (i.e. a candidate browsing jobs), you should use the following logic to decide
which of the templates to use:
BORROW FROM REDIRECT LOGIC
</p> 

<h2>Job details page</h2>

<p>Your app needs to include a 
 


This logic is needed when a visitor:

- arrives at a job through one of the public or private URL for the job
- 

It results in one of these happening:
- the page is served as normal
- a 302 redirect is served to:
	- the "other" URL (e.g. if they started at public, they get redirected to private) 
	- an error page "You aren't allowed to see this - click to go _home_"



The logic here is different from whether you can apply or not - we don't want anyone to be prevented from
seeing publicly open jobs (they may want to refer a friend).

canApplyForPublic
	yes
		logged in and does not have "internal" role
	no
		logged in and has "internal" role
		not logged in and coming from internal IP
	maybe
		not logged in

canLandOnPublic (always true)
		
canApplyForPrivate
canLandOnPrivate
	yes
		not logged in and coming from internal IP
		logged in and has "internal" role
	no
		logged in and does not have "internal" role
	maybe
		not logged in



The rendering logic on your job details page should check that the job is indeed
visible and if not say "not visible" without changing the URL
 


Protect all private pages with SSO

All private pages on the job board should be protected using principal type of candidate.

This guarantees that only candidates who are logged in can reach those pages.

Other strategies are possible (e.g. causing the same page to render differently
depending on whether the candidate is logged in or not) but these require your app
to have more involvement in managing SSO.
 

Perform redirects for candidates arriving at the wrong job details page

Sometimes candidates will arrive at a job via the wrong URL. For example, an internal candidate
viewing a job at work may share the link with a friend via email. The friend is not an employee
so is not allowed to view the job's internal details. Rather than simply display an error page, your
app should redirect them to the public view of the job.

The logic below may be useful to redirect (via http 302) candidates to the appropriate page, while
avoiding redirect loops.


landing on public page
	// candidate may or may not be logged in
	// try to steer internals to the internal view
	if job is open internally
		if canLandOnPrivate in (yes, maybe)
			redirect to private page
		else
			no redirect
	else
 		// job may not be open externally - don't check, the page will render with "job not available" (URL stays kosher)	
		no redirect

landing on internals page
	// Since page is SSO-protected, we know candidate is logged in at this point
	-- try to steer externals to the external view
	if job is open externally
		if canLandOnInternal in (no) and canLandOnExternal in (maybe, yes)
			redirect to external view
		else
			no redirect
	else
		no redirect

* must attach tracker parameter when redirecting




Displaying jobs

	Description

	Displaying if the job is internal only
	
	Injecting "per job" widgets/apply links
		- by either on behalf of, or anonymous

	Passing tracker through to injectors above

	Displaying customer-specific job items (custom data)


Top-level information

	Injection of "register" button

<h2>Login</h2>

<p>Most of the pages on your job board are likely to be publicly visible.
</p>

<p>You can also create SSO-protected pages that candidates must log in to see - for example a
page where the candidate can see their saved jobs would be protected.
</p>

<p>You can also create SSO-protected pages where the candidate must not only log in, but must also
hold some role - for example a page displaying a job that is only open to candidates holding the role
"internal".
</p>




where the candidate can see their saved jobs would be protected.
</p>

 


- eg for saved jobs, reliable internals detection

	Displaying logged in candidate's name
	

Handling internals
	- grabbing role from incoming SAML assertion
	- checking IP address
	- using login
	- restricting jobs

Injecting "master" items
	- by either on behalf of, or anonymous

Incoming traffic (matching URI template)


Generating trackers for anonymous users

Shadow ATS pages (SnapHire)






<h2>Reload categories</h2>

<p>Periodically/ at setup time/ prior to an upload, myupload grabs the latest categories and category values (these may have changed).
</p>

<p>First fetch all categories.

<div class='codeBlock'>
curl -H "Authorization: gjKUy7Y7Ehy0KgE32" \
https://uploadtenant.myuploader.tazzy.io/apps/jobboardapp/dev/tas/categories

<div class='clientInclude' data-href='../examples/categories-simple.json'></div>
</div>
</p>

<p>Next fetch values for all categories individually. e.g.:
<div class='codeBlock'>
curl -H "Authorization: gjKUy7Y7Ehy0KgE32" \
https://uploadtenant.myuploader.tazzy.io/apps/jobboardapp/dev/tas/categories/byID/10022/values

<div class='clientInclude' data-href='../examples/categoryValues-mockLocations.json'></div>
</div>
</p>

<h2>Prepare jobset</h2>

<p>myuploader extracts jobs (e.g. via scraping/extracting from source database/APIs) from the source system.
</p>

<p>Maps jobs to correct category values, e.g. Organization, Expertise, Location
</p>

<p>Create master "jobSets" document as below. This is a complete list of all advertised jobs - any jobs not in this list will be removed from the target.
</p>

<h2>Perform upload</h2>

<div class='codeBlock'>
curl -X POST -H "Authorization: gjKUy7Y7Ehy0KgE32" \
https://uploadtenant.myuploader.tazzy.io/apps/jobboardapp/dev/tas/jobSets

<div class='clientInclude' data-href='../examples/jobSet-simple.json'></div>

Response:
<div class='clientInclude' data-href='../examples/jobSetResponse-simple.json'></div>
</div>

<h2>Process response</h2>

<p>Review progress logs from POST /jobSets
</p>

<p>Communicate about errors (e.g. badly categorised jobs)
</p>

<p>Email/communicate summaries of progress to affected parties (multiple?)
</p>


<script>
$(document).ready(function() {

	renderSequenceDiagrams();
	renderClientIncludes();
	renderTOC();
});
</script>


</body>
</html>