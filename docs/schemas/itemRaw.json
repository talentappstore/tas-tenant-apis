{
  "$schema": "http://json-schema.org/draft-04/schema",
  "definitions": {

    "tas-file": {
      "type": "object",
      "properties": {
        "data": {
          "type": "string",
          "media": {
              "binaryEncoding": "base64"
          }
        },
        "mimeType":   { "type": "string" },
        "name":       { "type": "string" },
        "via":        { "type": "string" },
        "url":        { "type": "string" },
        "confirmUrl": { "type": "string" }
      }
    },

    "tas-stringAnswer": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string"
        }
      }
    },

    "tas-chronoAnswer": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string"
        }
      }
    },

    "tas-singleLineAnswer": {
      "description": "A single line of plain text",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["singleLine"]
             }
           }
         }
      ]
    },

    "tas-multilineAnswer": {
      "description": "Multiple lines of plain text",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["multiline"]
             }
           }
         }
      ]
    },

    "tas-numberAnswer": {
      "description": "A 32-bit integer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["number"]
        },
        "value": {
          "type": "integer",
          "multipleOf" : 1,
          "minimum": -2147483648,
          "maximum": 2147483647
        }
      }
    },

    "tas-boolAnswer": {
      "description": "A binary answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["bool"]
        },
        "value": {
          "type": "boolean"
        }
      }
    },

    "tas-imageAnswer": {
      "description": "An image file",
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/tas-file" },
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["image"]
            },
            "format": {
              "description": "Mime type of file",
              "type": "string"
            }
          }
        }
      ]
    },

    "tas-documentAnswer": {
      "description": "An uploaded document",
      "type": "object",
      "allOf": [
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["document"]
            }
          }
        },
        { "$ref": "#/definitions/tas-file" }
      ]
    },

    "tas-audioAnswer": {
      "description": "A sound file",
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/tas-file" },
        { "properties": {
            "type": {
              "type": "string",
              "enum": ["audio"]
            },
            "language": {
              "description": "Recorded language",
              "type": "string"
            }
          }
        }
      ]
    },

    "tas-enumDetailsAnswer": {
      "description": "A multi-choice answer, possibly with further details",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enumDetails"]
        },
        "value": {
          "description": "Selections and details for this item",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "choice":  {"type": "string"},
              "details": {"type": "string"}
            }
          }
        }
      }
    },

    "tas-enumQuestionsAnswer": {
      "description": "A multi-level answer",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["enumQuestions"]
        },
        "value": {
          "description": "Selections and details for this item",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "choice":  {"type": "string"},
              "answers": {
                 "type": "array",
                 "items": {
                    "$ref": "#"
                 }
              }
            }
          }
        }
      }
    },

    "tas-categoryAnswer": {
      "description": "A list of selected category values",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["category"]
        },
        "value": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },

    "tas-sheetAnswer": {
      "description": "Rows of answers",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["sheet"]
        },
        "rows": {
          "description": "Array of submitted rows",
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "$ref": "#"
            }
          }
        }
      }
    },

    "tas-wysiwygAnswer": {
      "description": "Markdown-formatted text",
      "allOf": [
         { "$ref": "#/definitions/tas-stringAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["wysiwyg"]
             }
           }
         }
      ]
    },

    "tas-dateAnswer": {
      "description": "A date",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["date"]
             }
           }
         }
      ]
    },

    "tas-timeAnswer": {
      "description": "A time of day",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["time"]
             }
           }
         }
      ]
    },

    "tas-datetimeAnswer": {
      "description": "A date and time",
      "allOf": [
         { "$ref": "#/definitions/tas-chronoAnswer" },
         { "properties": {
             "type": {
               "type": "string",
               "enum": ["datetime"]
             }
           }
         }
      ]
    },

    "tas-salaryAnswer": {
      "description": "A salary value",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["salary"]
        },
        "value": {
          "description": "Answer for this item",
          "type": "string"
        }
      }
    }
  },
  "type": "object",
  "oneOf": [
    { "$ref": "#/definitions/tas-singleLineAnswer" },
    { "$ref": "#/definitions/tas-multilineAnswer" },
    { "$ref": "#/definitions/tas-numberAnswer" },
    { "$ref": "#/definitions/tas-boolAnswer" },
    { "$ref": "#/definitions/tas-imageAnswer" },
    { "$ref": "#/definitions/tas-documentAnswer" },
    { "$ref": "#/definitions/tas-audioAnswer" },
    { "$ref": "#/definitions/tas-enumDetailsAnswer" },
    { "$ref": "#/definitions/tas-categoryAnswer" },
    { "$ref": "#/definitions/tas-sheetAnswer" },
    { "$ref": "#/definitions/tas-wysiwygAnswer" },
    { "$ref": "#/definitions/tas-dateAnswer" },
    { "$ref": "#/definitions/tas-timeAnswer" },
    { "$ref": "#/definitions/tas-datetimeAnswer" },
    { "$ref": "#/definitions/tas-salaryAnswer" }
  ]
}
